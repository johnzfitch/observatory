# Phase 4: Clipboard Paste Support

## Time: 30 minutes

## File: index.html (add to existing JS)

## Purpose

Let users paste images directly from clipboard (Ctrl+V / Cmd+V).
Common UX pattern - users expect this to work.

## Implementation

```js
function setupClipboardPaste() {
  document.addEventListener('paste', async (e) => {
    const items = e.clipboardData?.items;
    if (!items) return;

    for (const item of items) {
      if (item.type.startsWith('image/')) {
        e.preventDefault();
        
        const blob = item.getAsFile();
        if (!blob) continue;

        // Convert blob to File with proper name
        const extension = item.type.split('/')[1] || 'png';
        const file = new File(
          [blob], 
          `pasted-image-${Date.now()}.${extension}`, 
          { type: item.type }
        );

        // Use existing file handler
        handleFile(file);
        
        // Show feedback
        showToast('Image pasted from clipboard');
        
        break; // Only handle first image
      }
    }
  });
}

// Simple toast notification (if not already present)
function showToast(message, duration = 3000) {
  // Check if toast container exists
  let container = document.querySelector('.toast-container');
  if (!container) {
    container = document.createElement('div');
    container.className = 'toast-container';
    document.body.appendChild(container);
  }

  const toast = document.createElement('div');
  toast.className = 'toast';
  toast.textContent = message;
  container.appendChild(toast);

  // Trigger animation
  requestAnimationFrame(() => {
    toast.classList.add('visible');
  });

  // Remove after duration
  setTimeout(() => {
    toast.classList.add('hiding');
    toast.addEventListener('transitionend', () => toast.remove());
  }, duration);
}

// Call in init()
setupClipboardPaste();
```

## CSS (add to styles.css)

```css
/* Toast notifications */
.toast-container {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 10000;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.toast {
  background: rgba(0, 0, 0, 0.9);
  color: #fff;
  padding: 12px 24px;
  border-radius: 8px;
  font-size: 0.875rem;
  opacity: 0;
  transform: translateY(10px);
  transition: all 0.3s ease;
}

.toast.visible {
  opacity: 1;
  transform: translateY(0);
}

.toast.hiding {
  opacity: 0;
  transform: translateY(-10px);
}
```

## Update Upload Area Hint

Find the upload area text and update it:

```html
<!-- Before -->
<p>Drop or select an image</p>

<!-- After -->
<p>Drop, select, or paste (Ctrl+V) an image</p>
```

## Supported Formats

- image/png
- image/jpeg
- image/webp
- image/gif

## Edge Cases

1. Paste non-image (text, files) → Ignored, no error
2. Paste while models loading → Image queued, analyzed when ready
3. Paste while analyzing → Should cancel current and start new (handled by handleFile)
4. Multiple images in clipboard → Only first is used

## Verify

1. Copy any image to clipboard (screenshot, copy from browser, etc.)
2. Focus the page
3. Press Ctrl+V (or Cmd+V on Mac)
4. Image should appear in preview
5. Toast shows "Image pasted from clipboard"
6. Analysis triggers (if models ready)

## Done when

- Paste works for all image types
- Toast feedback shows
- Hint text updated
- Non-images gracefully ignored
